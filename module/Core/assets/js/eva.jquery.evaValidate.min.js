(function(f){var a={lang:"zh",tipOptions:{direction:"above"},errorType:"tip",validOptions:{errorClass:"error",onfocusin:function(i){if(!f(i).hasClass("error")){return}this.element(i)},errorPlacement:function(i,j){e=f(j);if(e.hasClass("valid")){return false}e.evaTip("show",{direction:"above",content:i});return false},success:function(i){e.evaTip("hide",{effect:null})}}};var g={zh:{required:"\u8fd9\u662f\u4e00\u4e2a\u5fc5\u586b\u9879",remote:"\u8f93\u5165\u5df2\u88ab\u5360\u7528",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7535\u5b50\u90ae\u4ef6",url:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7f51\u5740",date:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165ISO\u683c\u5f0f\u7684\u65e5\u671f ",number:"\u8bf7\u8f93\u5165\u6570\u5b57",digits:"\u53ea\u80fd\u8f93\u5165\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u4fe1\u7528\u5361\u53f7",equalTo:"\u4e24\u6b21\u8f93\u5165\u4e0d\u4e00\u81f4",accept:"\u8bf7\u8f93\u5165\u62e5\u6709\u5408\u6cd5\u540e\u7f00\u540d\u7684\u5b57\u7b26\u4e32",maxlength:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u591a\u662f {0} \u7684\u5b57\u7b26\u4e32"),minlength:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u5c11\u662f {0} \u7684\u5b57\u7b26\u4e32"),rangelength:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u5b57\u7b26\u4e32"),range:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u503c"),max:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5927\u4e3a {0} \u7684\u503c"),min:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5c0f\u4e3a {0} \u7684\u503c")}};var e=null;var c=[];var d={hint:{errorPlacement:function(j,l){e=f(l);var i=j.text();if(e.hasClass("valid")||!i){return false}var k=e.parent();if(k.hasClass("holder")===false||e.is(":radio")||e.is(":checkbox")||e.is(":button")){e.evaTip("show",{direction:"above",content:i});return false}var m=k.find(".formhint");if(!m[0]){k.append('<p class="formhint">'+i+"</p>");m=k.find(".formhint");m.data("orgHint","")}else{if(!k.hasClass("error")){m.data("orgHint",m.html())}m.html(i)}k.addClass("error");return false},success:function(i){var j=e.parent();if(j.hasClass("holder")){var k=j.find(".formhint");j.removeClass("error");k.html(k.data("orgHint"))}e.evaTip("hide",{effect:null})}}};var h=function(m,j,n){if(this.optional(j)){return"dependency-mismatch"}var k=this.previousValue(j);if(!this.settings.messages[j.name]){this.settings.messages[j.name]={}}k.originalMessage=this.settings.messages[j.name].remote;this.settings.messages[j.name].remote=k.message;n=typeof n=="string"&&{url:n}||n;if(this.pending[j.name]){return"pending"}if(k.old===m){return k.valid}k.old=m;var i=this;this.startRequest(j);var l={};l[j.name]=m;f.ajax(f.extend(true,{url:n,mode:"abort",port:"validate"+j.name,dataType:"json",data:l,success:function(p){i.settings.messages[j.name].remote=k.originalMessage;var r=p.data==="";if(r){var o=i.formSubmitted;i.prepareElement(j);i.formSubmitted=o;i.successList.push(j);i.showErrors()}else{var s={};var q=i.defaultMessage(j,"remote");s[j.name]=k.message=f.isFunction(q)?q(m):q;i.showErrors(s)}k.valid=r;i.stopRequest(j,r)}},n));return"pending"};var b={getOptions:function(i){var j=f.extend({},a);return f.extend(j,i)},getValidOptions:function(i){var j=f.extend({},a.validOptions);return j},addValidOptions:function(i){},addRules:function(k){if(this===b){return false}var j=f(this);var i=j.data("evaValidateRules");if(!i){j.data("evaValidateRules",[k])}else{i.push(k);j.data("evaValidateRules",i)}return false},addInlineRules:function(k){var i=k.find("[data-v]");var l={};var j={};i.each(function(){j=f(this);l=f.parseJSON(j.attr("data-v"));j.rules("add",l)})},initForm:function(l){var m=b.getValidOptions();for(var k in d.hint){m[k]=d.hint[k]}if(f.browser.msie===true){l.find("[required]").each(function(){f(this).addClass("required")})}l.validate(m);var j=l.data("evaValidateRules");if(j){for(k in j){j[k]()}}b.addInlineRules(l)},init:function(i){i=b.getOptions(i);f.validator.messages=g[i.lang];f.validator.methods.remote=h;var j={};if(this===b){j=f("form:not(.novalidate)")}else{j=f(this)}j.each(function(){var l=f(this);var k=l.data("evaValidateInited");b.initForm(l)})},events:{onSubmitForm:function(){}}};f.fn.evaValidate=function(i){if(b[i]){b.init();return b[i].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof i==="object"||!i){return b.init.apply(this,arguments)}else{f.error("Method "+i+" does not exist on evaValidate")}}return false};f.evaValidate=b})(jQuery);
